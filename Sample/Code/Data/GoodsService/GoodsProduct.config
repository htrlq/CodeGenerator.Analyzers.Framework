<?xml version="1.0" encoding="utf-8"?>
<SQLConfig xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <SQLList>
    
    
    <SQL SQLKey="GoodsProduct.InsertGoodsProductUnit" ConnectionKey="MainWrite">
      <Text>
        <![CDATA[
          $BATCHINSERT${[
          INSERT INTO GOODS_PRODUCT_UNIT
          (
            ProductSysCode, 
            SourceUnitName,
            TargetUnitName, 
            Ratio,
            InUserSysNo,
            InUserName,
            InDate,
            CommonStatus
          )
          VALUES(
            @ProductSysCode,
            @SourceUnitName, 
            @TargetUnitName,
            @Ratio,
            @InUserSysNo,
            @InUserName,
            SYSDATE(3),
            @CommonStatus
            );
          ]} 
            ]]>
      </Text>
    </SQL>
    <SQL SQLKey="GoodsProduct.UpdateGoodsProductUnit" ConnectionKey="MainWrite">
      <Text>
        <![CDATA[
          $BATCHUPDATE${[
         UPDATE GOODS_PRODUCT_UNIT
          SET
            SourceUnitName = @SourceUnitName,
            TargetUnitName = @TargetUnitName,
            Ratio =@Ratio,
            EditUserSysNo = @EditUserSysNo,
            EditUserName = @EditUserName,
            EditDate = SYSDATE(3),
            CommonStatus = @CommonStatus
          WHERE SysNo = @SysNo
          ]} 
            ]]>
      </Text>
    </SQL>
    

    <SQL SQLKey="GoodsProduct.InsertGoodsProductThreshold" ConnectionKey="MainWrite">
      <Text>
        <![CDATA[
         
         $BATCHINSERT${[ INSERT INTO GOODS_PRODUCT_THRESHOLD
          (
            ProductSysCode, 
            LowerThreshold,
            UpperThreshold,
            InUserSysNo,
            InUserName,
            InDate,
            CommonStatus
          )
          VALUES(
            @ProductSysCode,
            @LowerThreshold, 
            @UpperThreshold,
            @InUserSysNo,
            @InUserName,
            SYSDATE(3),
            @CommonStatus
          );
          ]} 
            ]]>
      </Text>
    </SQL>
    <SQL SQLKey="GoodsProduct.UpdateGoodsProductThreshold" ConnectionKey="MainWrite">
      <Text>
        <![CDATA[
         $BATCHUPDATE${[ 
         UPDATE GOODS_PRODUCT_THRESHOLD
          SET
            LowerThreshold = @LowerThreshold,
            UpperThreshold = @UpperThreshold,
            EditUserSysNo = @EditUserSysNo,
            EditUserName = @EditUserName,
            EditDate = SYSDATE(3),
            CommonStatus = @CommonStatus
          WHERE SysNo = @SysNo
            ]}  ]]>
      </Text>
    </SQL>
    
    
    
    <SQL SQLKey="GoodsProduct.InsertGoodsProduct" ConnectionKey="MainWrite">
      <Text>
        <![CDATA[
          INSERT INTO GOODS_PRODUCT
          (
            SysCode,
            OrganizationCode,
            ProjectSysNo,
            ProductCode,
            ProductName,
            Model,
            BrandName,
            CategoryCode,
            Type,
            InUserSysNo,
            InUserName,
            InDate,
            CommonStatus
          )
          SELECT 
            @SysCode,
            @OrganizationCode,
            @ProjectSysNo,
            A.ProductCode,
            @ProductName,
            @Model,
            @BrandName,
            @CategoryCode,
            @Type,
            @InUserSysNo,
            @InUserName,
            SYSDATE(3),
            @CommonStatus
            from
           (
           SELECT CONCAT(SUBSTRING( @CategoryCode,2),LPAD(IFNULL(Max(SysNo),0)+1, 6 , '0')) AS ProductCode from GOODS_PRODUCT
           ) A
            ]]>
      </Text>
    </SQL>
    <SQL SQLKey="GoodsProduct.UpdateGoodsProduct" ConnectionKey="MainWrite">
      <Text>
        <![CDATA[
          UPDATE GOODS_PRODUCT
          SET 
            OrganizationCode=@OrganizationCode,
            ProjectSysNo=@ProjectSysNo,
            ProductCode=@ProductCode,
            ProductName=@ProductName,
            Model=@Model,
            BrandName=@BrandName,
            CategoryCode=@CategoryCode,
            Type=@Type,
            EditUserSysNo=@EditUserSysNo,
            EditUserName=@EditUserName,
            EditDate=SYSDATE(3),
            CommonStatus=@CommonStatus
            WHERE SysCode=@SysCode
            ;
            ]]>
      </Text>
    </SQL>


    <SQL SQLKey="GoodsProduct.GetProductIndex" ConnectionKey="MainRead">
      <Text>
        <![CDATA[
            SELECT COUNT(*)+1  FROM GOODS_PRODUCT 
            WHERE 
              #{ AND  CategoryCode=@CategoryCode }
            ;
            ]]>
      </Text>
    </SQL>


    <SQL SQLKey="GoodsProduct.QueryGoodsProduct" ConnectionKey="MainRead">
      <Text>
        <![CDATA[
                SELECT 
                      GP.SysNo,
                      GP.SysCode,
                      GP.OrganizationCode,
                      GP.ProjectSysNo,
                      GP.ProductCode,
                      GP.ProductName,
                      GP.Model,
                      GP.BrandName,
                      GP.CategoryCode,
                      GP.Type,
                      GP.InUserSysNo,
                      GP.InUserName,
                      GP.InDate,
                      GP.EditUserSysNo,
                      GP.EditUserName,
                      GP.EditDate,
                      GP.CommonStatus,
                      PC.CategoryName
                FROM GOODS_PRODUCT GP
                LEFT JOIN PRODUCT_CATEGORY PC 
                ON(GP.CategoryCode=PC.CategoryCode)
                WHERE
                #{ AND GP.ProjectSysNo =@ProjectSysNo }
                #{ AND GP.Type =@Type }
                #{ AND GP.OrganizationCode =@OrganizationCode }
                #{ AND GP.OrganizationCode IN(@OrgCodeList) }
                #{ AND GP.ProjectSysNo IN(@ProjectSysNoList) }
                #{ AND GP.ProductCode LIKE CONCAT('%',@ProductCode,'%') }
                #{ AND GP.ProductName LIKE CONCAT('%',@ProductName,'%') }
                #{ AND (GP.ProductName LIKE CONCAT('%',@Keywords,'%') OR GP.ProductCode LIKE CONCAT('%',@Keywords,'%') OR Model LIKE CONCAT('%',@Keywords,'%')) }
                #{ AND GP.SysCode IN (@SysCodes) }
                #{ AND GP.CommonStatus =@CommonStatus }
                ; 
            ]]>
      </Text>
    </SQL>
    <SQL SQLKey="GoodsProduct.GetExistProductCount" ConnectionKey="MainRead">
      <Text>
        <![CDATA[
            SELECT COUNT(*) FROM GOODS_PRODUCT 
            WHERE 
                CategoryCode=@CategoryCode 
               AND  Model=@Model 
               AND  BrandName=@BrandName 
               AND  ProductName=@ProductName
               AND CommonStatus<>-999
            ;
            ]]>
      </Text>
    </SQL>
    <SQL SQLKey="GoodsProduct.GetExistProductCountForUpdate" ConnectionKey="MainRead">
      <Text>
        <![CDATA[
            SELECT COUNT(*) FROM GOODS_PRODUCT 
            WHERE 
                CategoryCode=@CategoryCode 
               AND  Model=@Model 
               AND  BrandName=@BrandName 
               AND  ProductName=@ProductName
               AND  SysCode<>@SysCode
            ;
            ]]>
      </Text>
    </SQL>
    <SQL SQLKey="GoodsProduct.QueryGoodsProductThreshold" ConnectionKey="MainRead">
      <Text>
        <![CDATA[
              SELECT SysNo,
                  ProductSysCode,
                  LowerThreshold,
                  UpperThreshold,
                  InUserSysNo,
                  InUserName,
                  InDate,
                  EditUserSysNo,
                  EditUserName,
                  EditDate,
                  CommonStatus
              FROM goods_product_threshold
              WHERE
              #{ AND ProductSysCode=@ProductSysCode }
              #{ AND CommonStatus=@CommonStatus}
              ;

            ]]>
      </Text>
    </SQL>
    <SQL SQLKey="GoodsProduct.QueryGoodsProductUnit" ConnectionKey="MainRead">
      <Text>
        <![CDATA[
              SELECT 
                    SysNo,
                    ProductSysCode,
                    SourceUnitName,
                    TargetUnitName,
                    Ratio,
                    InUserSysNo,
                    InUserName,
                    InDate,
                    EditUserSysNo,
                    EditUserName,
                    EditDate,
                    CommonStatus
              FROM  goods_product_unit
              WHERE
              #{ AND ProductSysCode=@ProductSysCode }
              #{ AND CommonStatus=@CommonStatus}
              ;

            ]]>
      </Text>
    </SQL>

  
  </SQLList>
</SQLConfig>
